"use strict";(self.webpackChunkEmployeeExpenseCalculator=self.webpackChunkEmployeeExpenseCalculator||[]).push([[969],{4969:(A,d,r)=>{r.r(d),r.d(d,{EmployeeFormComponent:()=>X});var e=r(5879),p=r(6814),i=r(95),v=r(5455);const F=[{name:"Manager",allocation:300},{name:"Developer",allocation:1e3},{name:"QA Tester",allocation:500}];var c=r(2962),u=r(2840),g=r(824),a=r(3599),z=r(5094),T=r(6691),h=r(4041),C=r(855),E=r(1958),f=r(2920);function S(t,m){if(1&t&&e._UZ(0,"nz-option",15),2&t){const l=m.$implicit;e.Q6J("nzValue",l.name)("nzLabel",l.name)}}function b(t,m){if(1&t&&e._UZ(0,"nz-option",21),2&t){const l=m.$implicit;e.Q6J("nzLabel",l.name)("nzValue",l.id)("nzDisabled",l.disabled)}}function Z(t,m){1&t&&e._uU(0),2&t&&e.hij("and ",m.$implicit.length," more selected")}function J(t,m){if(1&t&&(e.TgZ(0,"div",3)(1,"nz-form-item")(2,"nz-form-label",16),e._uU(3,"Subordinates"),e.qZA(),e.TgZ(4,"nz-form-control",17)(5,"nz-select",18),e.YNc(6,b,1,3,"nz-option",19),e.qZA(),e.YNc(7,Z,1,1,"ng-template",null,20,e.W1O),e.qZA()()()),2&t){const l=e.MAs(8),n=e.oxw();e.xp6(2),e.Q6J("nzSm",8)("nzXs",24),e.xp6(2),e.Q6J("nzSm",14)("nzXs",24),e.xp6(1),e.Q6J("nzMaxTagCount",3)("nzMaxTagPlaceholder",l),e.xp6(1),e.Q6J("ngForOf",n.employeeList)}}const y=function(){return{xs:8,sm:16,md:24,lg:32}};let X=(()=>{var t;class m{get formControl(){return this.employeeForm.controls}constructor(n,o,s){this.fb=n,this.router=o,this.route=s,this.service=(0,e.f3M)(v.G),this.msg=(0,e.f3M)(T.dD),this.employeeForm=this.fb.nonNullable.group({id:[crypto.randomUUID(),i.kI.required],name:[null,[i.kI.required]],type:[null,[i.kI.required]],allocation:[{value:0,disabled:!0},i.kI.required],children:[[]]}),this.employeeList=[],this.employeeTypes=F,this.action=0,this.navigateUrl="/page/employee",this.getEmployeeList()}ngOnInit(){const n=this.route.snapshot.params.id;n&&this.getEmployeeDetails(n)}getEmployeeList(){this.service.read().subscribe(n=>{this.employeeList=n})}getEmployeeDetails(n){this.service.readById(n).subscribe(o=>{this.action=1,this.removeInvalidIds(o),this.employeeForm.patchValue(o)})}fetchInvalidIds(n){const o=[n.id];return n.refs&&n.refs?.length>0&&o.push(...n.refs),o}removeInvalidIds(n){const o=this.fetchInvalidIds(n);this.employeeList=this.employeeList.filter(s=>!o.includes(s.id))}onEmployeeTypeChange(n){const o=this.employeeTypes.find(s=>s.name===n);this.employeeForm.get("allocation")?.setValue(o?.allocation??0)}onCancel(){this.router.navigate([this.navigateUrl])}onSubmit(){this.employeeForm.valid?0===this.action?this.createEmployee():this.updateEmployee():this.markFormAsDirty()}createEmployee(){this.service.create(this.employeeForm.getRawValue()).subscribe({next:n=>{n.isSuccess?(this.msg.success(n.msg),this.router.navigate([this.navigateUrl])):this.msg.warning(n.msg)},error:n=>{this.msg.error(n?.error?.message||"Something went wrong")}})}updateEmployee(){this.service.update(this.employeeForm.getRawValue()).subscribe({next:n=>{n.isSuccess?(this.msg.success(n.msg),this.router.navigate([this.navigateUrl])):this.msg.warning(n.msg)},error:n=>{this.msg.error(n?.error?.message||"Something went wrong")}})}markFormAsDirty(){Object.values(this.employeeForm.controls).forEach(n=>{n.invalid&&(n.markAsDirty(),n.updateValueAndValidity({onlySelf:!0}))})}}return(t=m).\u0275fac=function(n){return new(n||t)(e.Y36(i.qu),e.Y36(h.F0),e.Y36(h.gz))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-employee-form"]],standalone:!0,features:[e.jDz],decls:31,vars:21,consts:[[3,"nzBordered","nzTitle"],["nz-form","",3,"formGroup","ngSubmit"],["nz-row","",3,"nzGutter"],["nz-col","","nzXs","24","nzSm","24","nzMd","12","nzXl","8","nzXXl","6"],["nzRequired","","nzFor","name",3,"nzSm","nzXs"],["nzErrorTip","Mandatory Field",3,"nzSm","nzXs"],["nz-input","","formControlName","name","id","name"],["nzRequired","","nzFor","type",3,"nzSm","nzXs"],["nzShowSearch","","nzAllowClear","","nzPlaceHolder","Select a type","formControlName","type",3,"ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["nzRequired","","nzFor","allocation",3,"nzSm","nzXs"],["nz-input","","formControlName","allocation","id","allocation"],["nz-col","","nzXs","24","nzSm","24","nzMd","12","nzXl","8","nzXXl","6",4,"ngIf"],["nz-button","","nzType","primary"],["nz-button","",3,"click"],[3,"nzValue","nzLabel"],["nzFor","children",3,"nzSm","nzXs"],[3,"nzSm","nzXs"],["nzMode","multiple","nzPlaceHolder","Please select","formControlName","children",3,"nzMaxTagCount","nzMaxTagPlaceholder"],[3,"nzLabel","nzValue","nzDisabled",4,"ngFor","ngForOf"],["tagPlaceHolder",""],[3,"nzLabel","nzValue","nzDisabled"]],template:function(n,o){1&n&&(e.TgZ(0,"nz-card",0)(1,"form",1),e.NdJ("ngSubmit",function(){return o.onSubmit()}),e.TgZ(2,"div",2)(3,"div",3)(4,"nz-form-item")(5,"nz-form-label",4),e._uU(6,"Name"),e.qZA(),e.TgZ(7,"nz-form-control",5),e._UZ(8,"input",6),e.qZA()()(),e.TgZ(9,"div",3)(10,"nz-form-item")(11,"nz-form-label",7),e._uU(12,"Type"),e.qZA(),e.TgZ(13,"nz-form-control",5)(14,"nz-select",8),e.NdJ("ngModelChange",function(x){return o.onEmployeeTypeChange(x)}),e.YNc(15,S,1,2,"nz-option",9),e.qZA()()()(),e.TgZ(16,"div",3)(17,"nz-form-item")(18,"nz-form-label",10),e._uU(19,"Allocation"),e.qZA(),e.TgZ(20,"nz-form-control",5),e._UZ(21,"input",11),e.qZA()()(),e.YNc(22,J,9,7,"div",12),e.qZA(),e.TgZ(23,"div",2)(24,"div",3)(25,"nz-form-item")(26,"nz-form-control")(27,"button",13),e._uU(28,"Submit"),e.qZA(),e.TgZ(29,"button",14),e.NdJ("click",function(){return o.onCancel()}),e._uU(30,"Cancel"),e.qZA()()()()()()()),2&n&&(e.Q6J("nzBordered",!1)("nzTitle",1===o.action?"Edit Employee":"Add Employee"),e.xp6(1),e.Q6J("formGroup",o.employeeForm),e.xp6(1),e.Q6J("nzGutter",e.DdM(19,y)),e.xp6(3),e.Q6J("nzSm",8)("nzXs",24),e.xp6(2),e.Q6J("nzSm",14)("nzXs",24),e.xp6(4),e.Q6J("nzSm",8)("nzXs",24),e.xp6(2),e.Q6J("nzSm",14)("nzXs",24),e.xp6(2),e.Q6J("ngForOf",o.employeeTypes),e.xp6(3),e.Q6J("nzSm",8)("nzXs",24),e.xp6(2),e.Q6J("nzSm",14)("nzXs",24),e.xp6(2),e.Q6J("ngIf",o.formControl.name.value&&"Manager"===o.formControl.type.value),e.xp6(1),e.Q6J("nzGutter",e.DdM(20,y)))},dependencies:[p.ez,p.sg,p.O5,i.UX,i._Y,i.Fj,i.JJ,i.JL,i.sg,i.u,c.vh,c.bd,u.sL,u.ix,C.w,E.dQ,a.U5,f.t3,f.SK,a.Lr,a.Nx,a.iK,a.Fd,g.o7,g.Zp,z.LV,z.Ip,z.Vq],styles:["[nz-button][_ngcontent-%COMP%]{margin-right:8px;margin-bottom:12px}"]}),m})()}}]);